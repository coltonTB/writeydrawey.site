(window.webpackJsonp=window.webpackJsonp||[]).push([[7],{KnIj:function(t,e,a){"use strict";function n(){return(n=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var a=arguments[e];for(var n in a)Object.prototype.hasOwnProperty.call(a,n)&&(t[n]=a[n])}return t}).apply(this,arguments)}a.r(e),a.d(e,"default",(function(){return B}));var r=a("o0o1"),c=a.n(r),o=a("HaE+"),i=a("1OyB"),s=a("vuIU"),u=a("JX7q"),l=a("Ji7U"),p=a("md7G"),f=a("foSv"),d=a("rePB"),m=a("q1tI"),h=a.n(m),v=a("aSVQ"),y=a("nOHt"),g=a.n(y),b=a("CafY"),S=a("hahi"),O=a("MbLX"),I=h.a.createElement;function j(t){var e=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var a,n=Object(f.a)(t);if(e){var r=Object(f.a)(this).constructor;a=Reflect.construct(n,arguments,r)}else a=n.apply(this,arguments);return Object(p.a)(this,a)}}var w=function(t){Object(l.a)(a,t);var e=j(a);function a(){return Object(i.a)(this,a),e.apply(this,arguments)}return Object(s.a)(a,[{key:"render",value:function(){return I("div",{className:"full-height"},I(O.a,{noLogo:!0,noHome:404!==this.props.statusCode}),I("div",{className:"home flex-container"},404==this.props.statusCode?I("p",null,"We couldn't find a game here"):I("div",{className:"logo"},I(S.a,null))))}}]),a}(h.a.Component),N=a("a3/r"),k=a("qoWs"),C=a("F/0o"),x=h.a.createElement;function R(t){var e=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var a,n=Object(f.a)(t);if(e){var r=Object(f.a)(this).constructor;a=Reflect.construct(n,arguments,r)}else a=n.apply(this,arguments);return Object(p.a)(this,a)}}var E=function(t){Object(l.a)(a,t);var e=R(a);function a(){var t;return Object(i.a)(this,a),t=e.call(this),Object(d.a)(Object(u.a)(t),"onStartClick",(function(){k.g({gameId:t.props.gameState.id})})),Object(d.a)(Object(u.a)(t),"onNextRoundClick",(function(){k.e({gameId:t.props.gameState.id,round:t.props.gameState.round+1})})),Object(d.a)(Object(u.a)(t),"onEndGameClick",(function(){k.c({gameId:t.props.gameState.id})})),t}return Object(s.a)(a,[{key:"render",value:function(){var t=this.props,e=t.gameState,a=t.viewer,n=e.admin===a.userId,r={},c=0;e.players.forEach((function(t){var a=e.playerInput.find((function(a){return a.playerId===t.playerId&&a.round===e.round}));a&&c++,r[t.playerId]=a}));var o=c===e.players.length;return x("div",{className:"content-container"},x(O.a,{noHome:!0,textOverride:"waiting for others..."}),x("div",{className:"waiting flex-container"},x("div",{className:"players"},this.props.gameState.players.map((function(t){return x("h3",{title:r[t.playerId]?"ready":"waiting",className:r[t.playerId]?"":"player--notready",key:t.playerId},t.playerName)}))),x("div",{className:"bottom-margin"},n&&this.props.gameState.state===C.GAME_STATE.STARTING&&x(N.a,{onClick:this.onStartClick,type:"3"},"Start Game"),n&&o&&this.props.gameState.state===C.GAME_STATE.PLAYING&&x(N.a,{onClick:this.onNextRoundClick,type:"3"},"Next Round"),n&&o&&this.props.gameState.state===C.GAME_STATE.PLAYING&&x(N.a,{onClick:this.onEndGameClick,type:"5"},"End Game"))))}}]),a}(h.a.Component),D=h.a.createElement;function T(t){var e=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var a,n=Object(f.a)(t);if(e){var r=Object(f.a)(this).constructor;a=Reflect.construct(n,arguments,r)}else a=n.apply(this,arguments);return Object(p.a)(this,a)}}var A=function(t){Object(l.a)(a,t);var e=T(a);function a(){var t;return Object(i.a)(this,a),t=e.call(this),Object(d.a)(Object(u.a)(t),"countdown",(function(){})),Object(d.a)(Object(u.a)(t),"onDescriptionChange",(function(e){t.setState({description:e.target.value})})),Object(d.a)(Object(u.a)(t),"onStartDrawingClick",(function(){t.countdown(),t.setState({startedDrawing:!0})})),Object(d.a)(Object(u.a)(t),"onPhraseSubmit",Object(o.a)(c.a.mark((function e(){var a,n;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,k.f({playerId:t.props.viewer.userId,gameId:t.props.gameState.id,round:t.props.gameState.round,phrase:t.state.description});case 3:a=e.sent,n=a.data.response,t.props.onUpdateState&&t.props.onUpdateState(n),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(0),console.log(e.t0);case 11:case"end":return e.stop()}}),e,null,[[0,8]])})))),Object(d.a)(Object(u.a)(t),"onDrawingSubmit",Object(o.a)(c.a.mark((function e(){var a,n,r;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,a=document.getElementById("drawingCanvas").contentWindow.document.getElementById("myCanvas").toDataURL("image/png"),e.next=4,k.f({playerId:t.props.viewer.userId,gameId:t.props.gameState.id,round:t.props.gameState.round,drawing:a});case 4:n=e.sent,r=n.data.response,t.props.onUpdateState&&t.props.onUpdateState(r),e.next=12;break;case 9:e.prev=9,e.t0=e.catch(0),console.log(e.t0);case 12:case"end":return e.stop()}}),e,null,[[0,9]])})))),t.state={description:"",startedDrawing:!1,time:590},t}return Object(s.a)(a,[{key:"componentDidMount",value:function(){Boolean(this.props.gameState.round%2)||this.countdown()}},{key:"componentWillUnmount",value:function(){this.interval&&window.clearInterval(this.interval)}},{key:"getLeftHandPlayer",value:function(){var t=this.props,e=t.gameState,a=t.viewer,n=e.players.findIndex((function(t){return t.playerId===a.userId})),r=0===n?e.players.length-1:n-1,c=e.players[r].playerId;return e.playerInput.find((function(t){return t.round===e.round-1&&t.playerId===c}))||{}}},{key:"render",value:function(){var t=this;if(!this.props.viewer||!this.props.gameState.players.find((function(e){return e.playerId===t.props.viewer.userId})))return D("div",null,D("h1",null,"This game is currently being played"),D("a",{href:"/"},D(N.a,{type:"2"},"Go Home")));this.props.viewer.userId;var e=Boolean(this.props.gameState.round%2),a=this.getLeftHandPlayer(),n=this.state.startedDrawing;return D("div",{className:"playing full-height"},D(O.a,{textOverride:"round ".concat(this.props.gameState.round)}),e?n?D("div",{className:"flex-container"},D("iframe",{id:"drawingCanvas",src:"/canvas/index.html"}),D("div",{className:"bottom-margin"},D("h3",null,'"',a.phrase,'"'),D(N.a,{onClick:this.onDrawingSubmit,type:"4"},"Done"))):D("div",{className:"flex-container"},D("h1",null,'Draw "',a.phrase,'"'),D(N.a,{onClick:this.onStartDrawingClick},"Start")):D("div",{className:"flex-container"},D("img",{className:"playerDrawing",src:a.drawing}),D("div",{className:"bottom-margin"},D("span",{className:"input-wrapper"},D("h3",null,"describe this:"),D("input",{onChange:this.onDescriptionChange,value:this.state.description})),D(N.a,{onClick:this.onPhraseSubmit,type:"4"},"Okay"))))}}]),a}(h.a.Component),G=h.a.createElement;function P(t){var e=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var a,n=Object(f.a)(t);if(e){var r=Object(f.a)(this).constructor;a=Reflect.construct(n,arguments,r)}else a=n.apply(this,arguments);return Object(p.a)(this,a)}}var L=function(t){Object(l.a)(a,t);var e=P(a);function a(){var t;return Object(i.a)(this,a),t=e.call(this),Object(d.a)(Object(u.a)(t),"onNameInputChanage",(function(e){t.setState({playerName:e.target.value})})),Object(d.a)(Object(u.a)(t),"onPhraseInputChange",(function(e){t.setState({phrase:e.target.value})})),Object(d.a)(Object(u.a)(t),"onSubmit",Object(o.a)(c.a.mark((function e(){var a;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,a={playerName:t.state.playerName},t.validate(),e.next=5,k.a({gameId:t.props.gameState.id,player:a});case 5:return e.next=7,k.f({gameId:t.props.gameState.id,phrase:t.state.phrase,round:0});case 7:e.next=12;break;case 9:e.prev=9,e.t0=e.catch(0),console.log(e.t0);case 12:case"end":return e.stop()}}),e,null,[[0,9]])})))),t.state={playerId:"",playerName:"",phrase:""},t}return Object(s.a)(a,[{key:"componentDidMount",value:function(){}},{key:"validate",value:function(){if(!this.state.phrase)throw new Error("Missing Phrase");if(!this.props.gameState.id)throw new Error("No Game ID found")}},{key:"render",value:function(){return G("div",{className:"content-container"},G(O.a,{noHome:!0,textOverride:"joining game..."}),G("div",{className:"join flex-container"},G("div",{className:"input-container"},G("div",{className:"input-container-flex"},G("h3",{className:"mono"},"your name:"),G("span",{className:"input-wrapper"},G("input",{onChange:this.onNameInputChanage,value:this.state.playerName}))),G("div",{className:"input-container-flex"},G("h3",{className:"mono"},"a phrase:"),G("span",{className:"input-wrapper"},G("input",{onChange:this.onPhraseInputChange,value:this.state.phrase}),G("span",{className:"subtext"},"(anything)")))),G(N.a,{onClick:this.onSubmit,type:"2"},"Next")))}}]),a}(h.a.Component),M=h.a.createElement;function _(t){var e=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var a,n=Object(f.a)(t);if(e){var r=Object(f.a)(this).constructor;a=Reflect.construct(n,arguments,r)}else a=n.apply(this,arguments);return Object(p.a)(this,a)}}var U=function(t){Object(l.a)(a,t);var e=_(a);function a(){return Object(i.a)(this,a),e.apply(this,arguments)}return Object(s.a)(a,[{key:"render",value:function(){var t=function(t){var e=t.players.map((function(t){return t.playerId}));return t.players.map((function(a,n){for(var r=[],c=n,o=function(){var a=e[c];r.push(t.playerInput.find((function(t){return t.round===i&&t.playerId===a}))),c=c>=e.length-1?0:c+1},i=0;i<=t.round;i++)o();return{player:a,cards:r}}))}(this.props.gameState),e=this.props.gameState.players.reduce((function(t,e){return t[e.playerId]=e.playerName,t}),{});return M("div",{className:"game-over content-container"},M(O.a,{textOverride:"game over!"}),M("div",{className:"full-height center"},t.map((function(t){return M("div",{key:t.player.playerId},t.cards.map((function(a,n){return a.phrase?0==n?M("div",{className:"game-over--section",key:a.ts},M("h2",null,'"',a.phrase,'"'),M("div",{className:"italic"},"--",t.player.playerName)):M("div",{className:"game-over--section",key:a.ts},M("h3",{title:e[a.playerId]},'"',a.phrase,'"')):M("div",{className:"game-over--section",key:a.ts},M("img",{title:e[a.playerId],src:a.drawing}))})))}))))}}]),a}(h.a.Component),H=(a("00et"),h.a.createElement);function q(t){var e=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var a,n=Object(f.a)(t);if(e){var r=Object(f.a)(this).constructor;a=Reflect.construct(n,arguments,r)}else a=n.apply(this,arguments);return Object(p.a)(this,a)}}var B=function(t){Object(l.a)(a,t);var e=q(a);function a(t){var n,r=t.gameState,c=t.viewer,o=t.statusCode;return Object(i.a)(this,a),n=e.call(this),Object(d.a)(Object(u.a)(n),"updateGameState",(function(t){n.setState({gameState:t})})),n.state={gameState:r||C.INITIAL_STATE,viewer:c,error:null,statusCode:o},n}return Object(s.a)(a,[{key:"componentDidMount",value:function(){var t=this;this.interval=window.setInterval(Object(o.a)(c.a.mark((function e(){var a,n,r,o;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a=g.a.query.slug){e.next=3;break}return e.abrupt("return");case 3:return e.prev=3,e.next=6,k.d({gameId:a});case 6:n=e.sent,r=n.gameState,o=n.viewer,t.setState({gameState:r,viewer:o}),r.state===C.GAME_STATE.DONE&&window.clearInterval(t.interval),e.next=18;break;case 13:e.prev=13,e.t0=e.catch(3),console.log(e.t0),t.setState({gameState:C.INITIAL_STATE,statusCode:Object(v.get)(e.t0,"request.status")}),window.clearInterval(t.interval);case 18:case"end":return e.stop()}}),e,null,[[3,13]])}))),2e3)}},{key:"getComponent",value:function(){var t=this.state,e=t.gameState,a=t.viewer;return e.state===C.GAME_STATE.DONE?U:function(t,e){try{var a=t.playerInput.find((function(a){return a.round===t.round&&a.playerId===e.userId}));return Boolean(a)}catch(n){return!1}}(e,a)?E:e.state===C.GAME_STATE.STARTING?L:e.state===C.GAME_STATE.PLAYING?A:w}},{key:"render",value:function(){var t=this.getComponent();return H(b.a,{theme:"light"},this.state.viewer&&H("div",{style:{textAlign:"left",position:"absolute"}},this.state.viewer.name),H(t,n({},this.state,{onUpdateState:this.updateGameState})))}}],[{key:"getInitialProps",value:function(){var t=Object(o.a)(c.a.mark((function t(e){var a,n,r,o,i;return c.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(a=e.req,(n=e.query).slug){t.next=3;break}return t.abrupt("return",{gameState:C.INITIAL_STATE,statusCode:200});case 3:return t.prev=3,t.next=6,k.d({gameId:n.slug},a);case 6:return r=t.sent,o=r.gameState,i=r.viewer,t.abrupt("return",{gameState:o,viewer:i,statusCode:200});case 12:return t.prev=12,t.t0=t.catch(3),console.log(t.t0),t.abrupt("return",{gameState:C.INITIAL_STATE,statusCode:404});case 16:case"end":return t.stop()}}),t,null,[[3,12]])})));return function(e){return t.apply(this,arguments)}}()}]),a}(h.a.Component)}}]);